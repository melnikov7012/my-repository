Проект: Обучение с учителем: качество модели
Описание проекта

Интернет-магазин «В один клик» продаёт разные товары:
 для детей, для дома, мелкую бытовую технику,
 косметику и даже продукты. Отчёт магазина за прошлый период показал,
 что активность покупателей начала снижаться.
 Привлекать новых клиентов уже не так эффективно:
 о магазине и так знает большая часть целевой аудитории. 
Возможный выход — удерживать активность постоянных клиентов.
 Сделать это можно с помощью персонализированных предложений.
«В один клик» — современная компания, поэтому её руководство 
не хочет принимать решения просто так — только на основе анализа данных
 и бизнес-моделирования. У компании есть небольшой отдел цифровых технологий,
 и вам предстоит побыть в роли стажёра в этом отделе. 
Итак, вашему отделу поручили разработать решение,
 которое позволит персонализировать предложения постоянным клиентам,
 чтобы увеличить их покупательскую активность.



В ходе выполнения проекта были проведены следующие мероприятия:

1. Загружено 4 файла:

    market_file - Таблица с данными о поведении покупателя на сайте, о коммуникациях с покупателем и его продуктовом поведении.
    market_time - Таблица с данными о выручке, которую получает магазин с покупателя, то есть сколько покупатель всего потратил за период взаимодействия с сайтом.
    market_money - Таблица с данными о времени (в минутах), которое покупатель провёл на сайте в течение периода
    money - Таблица с данными о среднемесячной прибыли покупателя за последние 3 месяца: какую прибыль получает магазин от продаж каждому покупателю.

2. Выполнена предобработка данных:

    Категориальные данные приведены к нижнему регистру, пробелы заменены подчеркиванием.
    Названия столбцов переименованы для удобства дальнейшей работы.
    Пропусков данных в датафреймах и дубликатов строк не обнаружено.
    Устранены опечатки в категориальных данных (неявные дубликаты)

3. Проведен исследовательский анализ данных:

КОЛИЧЕСТВЕННЫЕ ПРИЗНАКИ

    market_active_6_month - Cреднемесячное значение маркетинговых коммуникаций компании, которое приходилось на покупателя за последние 6 месяцев:

Распределение близкое к нормальному. Средняя покупательская активность меньше 3 операций выделяется из распределения, что подтверждается боксплотом. Пока удалять эти выбросы не будем, так как они отражают клиентов с малой активностью.

    market_active_current_month — количество маркетинговых коммуникаций в текущем месяце:

Несмотря на малую вариацию значений (3, 4, 5 операций), "нормальность" прослеживается. Также отсутствуют аномально малые значения мельше 3, что подтверждает правильность намерения отсечь клиентов с покупательной активностью менее 3 месяцев.

    duration — значение, которое показывает, сколько дней прошло с момента регистрации покупателя на сайте:

Распределение близкое к нормальному,хотя колокол растянут.Несмотря на то, что пик колокола прослеживается, в распределении присутствует составляющая равномерного распределения. Медианное значение duration почти равно среднему, аномальных выбросов не наблюдается. Отметим, последний пользователь зарегистрировался на сайте 110 дней назад - это более 3-х месяцев.

    promotional_purchases — среднемесячная доля покупок по акции от общего числа покупок за последние 6 месяцев:

Основная группа значений (0 - 0.5) близка к нормальному распределению.Медианное значение 0.24, наблюдается выброс значений в интервале 0.85 - 1.0 покупки за 6 мес. Аномальных покупок по акциям 165.Это 12.6% от общего числа клиентов.Ощутимая доля, поэтому не стали удалять эти данные.

    average_category_view_per_visit — Средний_просмотр_категорий_за_визит в течение последнего месяца.

Нормальное распределение с небольшим смещением влево.Ближе к распределению Пуассона.Выбросов нет.

    unpaid_products_items_quarter — общее число неоплаченных товаров в корзине за последние 3 месяца.

Похоже на распределение Пуассона. Наблюдаются аномальные значения более 8 неоплаченных товаров в корзине. Таких значений 14.Данные оставили, так как они информативны.

    service_error — число сбоев, которые коснулись покупателя во время посещения сайта.

Нормальное распределение без выбросов.

    pages_per_visit — среднее количество страниц, которые просмотрел покупатель за один визит на сайт за последние 3 месяца:

Нормальное распределение с небольшим смещением влево, если не считать аномалии в районе 4 - 6 страниц просмотра. Скорее всего это некое комфортное число просматриваемых страниц. Отметим это как особенность психологии пользователей.

    revenue — сумма выручки за период:

Типичное нормальное распределение.Медианное значение выручки составляет порядка 5000 рублей за период.Присуствует аномальнрое значение 106862 рубля. Клиент id = 215380 аномальный. Было решено удалить его из датафрейма.

    распределение выручки revenue по месяцам:

    Выручка за последние 3 месяца увеличивается:медианные значения 4809, 5005, 5180.При этом наблюдается последовательное (от месяца к месяцу) увеличение разброса значений выручки.То есть часть пользователей стала покупать товаров на меньшую сумму и большую суммы.Определенно меняется поведение покупателей.Теряется стабильность спроса.

    minutes — значение времени, проведённого на сайте, в минутах:

Нормальное распределение.Медианное время, проведенное на сайте в районе 13 минут.

-Распределение времени minutes, проведенного на сайтах по месяцам:

    Среднее время, проведенное на сайте, практически не изменилось.Однако поменялась форма распределения.Также в текущем месяце появилось увеличенное кол-во пользователей - около 140, находящихся на сайте 14 минут. В предыдущем месяце распределение нормальное, а в текущем тоже близкое к нормальному, при этом наблюдается небольшое смещение влево (в сторону уменьшения времени).

    profit — значение прибыли:

Нормальное распределение.Отметили выбросы на отрезке больше 7.0

Возможно, увеличение выручки - результат инерции (то, что было вложено в магазин ранее), если в дальнейшем не предпринять действий по заинтересованности клиентов, выручка тоже начнет падать.

КАТЕГОРИАЛЬНЫЕ ПРИЗНАКИ.

В разрезе категориальных признаков был рассмотрен основной файл "market_file". Помимо долевой оценки признаков как таковых, мы рассмотрели их в разрезе влияния на количественные признаки.

    'buying_activity' - целевой признак.

Примерно у трети клиентов (38.31%) наблюдается снижение покупательской активности.

    Взаимосвязь 'buying_activity' со следующими признаками:
    market_active_6_month - те клиенты, у которых число коммуникаций было меньше 3-х, они почти все снизили покупательскую активность (см. столбчатая диаграмма)
    market_active_current_month - в текущем месяце покупательская активность уже снижена вне зависимости от кол-ва коммуникаций.То есть у кого устойчивый интерес к продукции, тот покупает вне зависимости от коммуникаций, а у кого неустойчивый - на того уже коммуникации не влияют. Плохая теденция - падение интереса со стороны клиентов
    duration - активность снизилась у всех в схожей пропорции: как у постоянных клиентов, так и у новых.
    promotional_purchases - наибольшая доля снижения активности у любителей покупать по акции 0.8 - 1.0 покупок за 6 мес.Клиенты, мало покупающие по акции - 0.1 - 0.3 покупки за 6 мес.,незначительно снизили активность.То есть те, у кого устойчивый интерес к продукции сайта, на них акции слабо влияют.А у любителей акций упал интерес, значит, кол-во акций уменьшается.
        average_category_view_per_visit - наибольшая доля снижения интереса у тех, кто мало просматривает категорий. Почти полное снижение интереса у тех, кто просматривает 1 категорию.Далее чем больше просматривается категорий, тем устойчивее интерес.Иными словами, малый просмотр сайта является покзателем снижения интереса.
        unpaid_products_items_quarter - как и в предыдущем, чем больше остается неоплаченных товаров в корзине - больше 6-ти, тем ниже интерес.Хороший показатель снижения активности клиентов.
        service_error - число сбоев на сайте не влияет на активность клиентов.
        pages_per_visit - Также хороший показатель снижения активности. Почти все, кто смотрит меньше 3-х страниц за посещение, демонстрируют снижение активности.

Вывод: целевой параметр buying_activity зависит от всех количественных параметров, кроме duration и service_error.

    'service_type' 74% клиентов ощутили на себе сбои сервиса.Сервисные сбои распределены бессистемно, то есть не наблюдается каких-то особых групп, только которых это коснулось.

    'popular_category' Наиболее популярны товары для детей 25,28%.На 2 месте домашний текстиль 19.31%. Остальные равномерно уменьшаются до 10.62% - кухонная посуда.В общем, аномалий не наблюдается.

Вывод: Влияние категориальных признаков на количественные пропорционально долевому соотношению значений самих категориальных признаков.Каких-либо аномалий не обнаружено.

    Также было рассмотрено влияниет на снижение покупательской активности других категориальных признаков:

Снижение покупательской активности в зависимости от типа подписки:

    Снижение покупательской активности у клиентов премиум на 10% больше, чем у стандарт.

Снижение покупательской активности в зависимости от сбоев в системе:

    Снижение покупательской активности не зависит от сбоев в системе: наблюдаем практически равные доли в снижении активности 38.57% и 37.57%.

Снижение покупательской активности в зависимости от популярной категории товара:

    Наибольшее снижение покупательской активности у клиентов с любимыми категориями "кухонная_посуда" и "косметика и аксесуары" 47.83% и 47.09%.Немного меньше, но достаточно высокое у наиболее популярных категорий товаров "товары_для_детей" - 44.24% и "домашний_текстиль" - 40.64%.

4. Произведено объединение таблиц.

Выполнено объединение таблиц market_file, market_money, market_time.

Добавлены столбцы:

current_month - выручка за текущий_месяц; previous_month - выручка за предыдущий месяц; pre_previous_month - выручка за препредыдущий месяц; minutes_current - время, проведенное на сайте в текущем месяце; minutes_previous - время, проведенное на сайте в предыдущем месяце Удалены строки "id" 215348, 215357, 215359, 215380, которые были признаны аномальными в процессе исследовательского анализв данных. В итоге имеем подготовленный к дальнейшему анализу датафрейм market_pivot.

5. Корреляционный анализ данных:

Данные тепловой карты перекликаются с проведенным исследовательским анализом данных. Это видно по последней строке, где представлены коэф. корелляции покупательской активности в зависимости от других признаков.

Мультикоринеарности не наблюдается - максимальное значение коэф. корреляции 0.83 (меньше 0.9)

6. Использование пайплайнов

Лучшая модель:

LogisticRegression(C=1, penalty='l1', random_state=76, solver='liblinear'))

Метрика лучшей модели на тренировочной выборке: 0.9009226788772244

Метрика ROC-AUC на тестовой выборке: 0.8682258064516128 Время исполнения кода: 2.343949317932129

7. Анализ важности признаков

Наиболее важный признак - "мелкая бытовая техника и электроника"

Резюме по общей исследовательской части проекта:

определены основные тенденции в поведении групп клиентов, а именно:

    наметилась четкая тенденция к снижению активности клиентов.Пока этот процесс не отразился на выручке компании, но если ничего не предпринять, то падение выручки (и прибыли) с последующим оттоком клиентов не за горами.
    снижение активности клиентов происходит вне зависимости от типа подписки, от получаемых клиентами рассылок, как у постоянных, так и у относительно свежих подписчиков.
    из популярных категорий товаров стабильностью спроса выделяются технические товары. При этом их покупаю мало предположительно потому, что постоянные клиенты уже приобрели себе технику, а жизненный цикл у нее большой.Но техникой все равно продолжают интересоваться.
    есть тенденция к росту неоплаченных товаров в корзине, что говорит о снижении интереса к представленным на сайте товарам.
    уменьшается доля товаров, покупаемых по акциям.

8. Сегментация покупателей:

Был выбран следующий сегмент:

Анализ группы клиентов с высокой вероятностью снижения покупательской активности и наиболее высокой прибыльностью:

Снижение покупательской активности оценили по прогнозным меткам класса 1 целевого признака 'buying_activity'. Для этого:

    Применили модель обучения ко всей выборке данных, значения полученных вероятностей прописываем в столбец buying_activity_predict.

    С помощью применения порога выделии из выборки покупателей "прежний_уровень" так называемую "группу риска" - Это клиенты, которые уже снизили активность, но не настолько, чтобы быть классифицированными как "снизили". Это прямые кандидаты на дальнейшее снижение активности.

    Сравнили между собой группу риска и общий датасет, в результате чего сделали следующие выводы:

    техника_ для красоты и _здоровья - повышенный интерес, но мало покупают, при этом охотно покупают по акции.

    товары для детей - при общем падении интереса покупают много,но мало по акциям.Есть склонность покупать более дешевый товар, но товар по акциям не устраивает.

    мелкая бытовая_техника и_электроника - покупают мало, при этом предпочитают более дорогую технику.

сделал 1 коммит

делаем еще 1 коммит
